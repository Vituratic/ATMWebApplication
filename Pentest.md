# Pentest WebApplication

## Beschreibung IDE und Tools:
Betriebssystem: Windows 10 Version 1803 (Build 17134.407)  
IDE: IntelliJ IDEA 2018.2.6 (Ultimate Edition) Build #IU-182.5107.16  
Java 9  
Postman<br/>
[Firefox Add-on Cookie Manager v1.5](https://addons.mozilla.org/de/firefox/addon/a-cookie-manager/)<br/>
[Google Chrome Erweiterung EditThisCookie v1.4.9](https://chrome.google.com/webstore/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg?hl=de)

Kali Linux  2018.4-vbox-amd64  
OWASP ZAP 2.7.0 

Die zu testende Anwendung:  
https://github.com/TimSro/BiBiFi

## Information Gathering
Durchlauf mit ZAP um Übergabeparameter zu sehen:<br/>
![alt text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/info_gathering/ZAP_Scan.png)

## Identity Managment Testing
Registrierungs- und Password-Policy vorhanden.
Es werden benötigt:
- Vorname
- Nachname
- eMail
  - muss ein "@" enthalten
  - "@" darf nicht erstes oder letztes Zeichen sein
  - "@" darf nicht mehrfach vorkommen
  - nach dem "@" dürfen keine Sonderzeichen vorkommen
  - ";" darf nicht vorkommen
- Passwort:
  - mindestens 8 Zeichen
  - mindestens 1 Großbuchstabe
  - mindestens 1 Zahl
  - mindestens 2 Sonderzeichen

Account raten ist schwierig, da theoretisch jede eMail zur Anmeldung in Frage kommen kann.   

## Authentication Testing
Username und Passwort werden in der URL und im Request mitgesendet und sind damit anfällig ausgelesen zu werden.<br/>  
![alt_text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/auth/ZAP_Auth_Test.png)

Zudem, kann die Anzeige der Anwendung durch Manipulation der URL beeinflusst werden.<br/>
![alt_text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/auth/URL_manipulation.png)

Durch kopieren der SessionID kann sich ein unangemeldeter Nutzer in das System schleichen.  
![alt text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/session/sessionGcCookieTool.png)
![alt text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/session/sessionSuccessfulHijack.png)

## Authorization Testing
Es gibt keine Möglichkeit über das Einloggen als normaler Benutzer auf Funktionen des Admins zuzugreifen.  
Wenn man ausgeloggt ist, bleibt man ausgeloggt.

## Testing for Session Fixation
Dadurch, dass die beim aufrufen der Anwendung zugewiesene SessionID nach der authentifizierung die gleiche bleibt, kann ein Angreifer einem Nutzer einen Cookie mit einer gewünschten SessionID geben, welcher dann bei einer erfolgreichen anmeldung zum SessionID Hijacking genutzt werden kann.
![alt text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/session/vorher.png)<br/>
![alt text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/session/nachher.png)

## Input Validation Testing
Durch einfügen eines Slashes "/" in der URL kann ein Fehlercode 500 erzeugt werden.
![alt_text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/input_validation/url_manipulation.png)

### SQL Injection
Es wurde keine Möglichkeit zur SQL-Injection gefunden.

### XSS
Unter Anderem wurden die folgenden Eingaben getestet, führten jedoch zu keinem Ergebnis. Die getätigten Eingaben werden kodiert, somit ist die Anwendung gegenüber XSS geschützt.
![alt_text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/input_validation/xss_noResult_01.png)
![alt_text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/input_validation/xss_noResult_02.png)
![alt_text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/input_validation/xss_noResult_03.png)
![alt_text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/input_validation/xss_noResult_04.png)

## Testing for Error Handling
Wie schon oben aufgeführt, lassen sich ein paar Fehler erzeugen, jedoch keinerlei Stacktraces oder ähnliches auslesen.

## Business Logic Testing
Keine Vorhanden

## Client Side Testing
Die Seite ist gegen Clickjacking geschützt.  
Das haben wir [hiermit](https://github.com/RocketJulia/Pentest/tree/master/Dateien/Clickjacking.html) getestet.  
![alt text](https://github.com/Vituratic/ATMWebApplication/blob/master/screenshots/client_side/Clickjacking.png)
